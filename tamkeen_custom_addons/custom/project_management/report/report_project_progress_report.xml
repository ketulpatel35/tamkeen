<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="project_progress_report_header">
        <t t-foreach="docs" t-as="o">
            <div class="header">
                <t t-foreach="docs" t-as="o">
                    <div class="col-xs-8"
                         style="padding-top: 8%;font-size:12px;overflow:hidden;text-overflow: ellipsis;">
                        <b>Strategy and Projects Management</b>
                        <br/><br/><br/>
                        <t t-if="o.name">
                            <t t-if="o.code">
                                [<t t-esc="o.code"/>] <t t-esc="o.name"/>
                            </t>
                        </t>
                    </div>
                    <div class="col-xs-4 text-right"
                         style="padding-bottom:15px;font-size:17px;">
                        <img class="img-responsive" src="/project_management/static/src/img/logo_english.jpg" width="230px" height="75px"/>
                    </div>
                    <div class="text-center"
                         style="text-align:center;font-size:19px;">
                        <b style="text-align:center;font-size:22px;">Project
                            Progress Report
                        </b>
                    </div>
                    <div class="col-xs-1-5">
                        <div style="float:left;font-size:10px;">
                            Printed On:
                            <span
                                    t-esc="context_timestamp(datetime.datetime.now()).strftime('%d-%b-%Y')"/>
                            <br/>
                        </div>
                    </div>
                </t>
            </div>
        </t>
    </template>

    <template id="project_progress_report_footer"
              name="project_progress_report_footer">
        <t t-foreach="docs" t-as="o">
            <div class="footer">
                <div class="row">
                    <div class="col-xs-6" style="border-top: 1px solid #808080;font-size:12px;color:#808080;">
                        <t t-if="o.company_id">
                            <b>Address:</b>
                            <span>
                                <t t-if="o.company_id.street">
                                    <span t-field="o.company_id.street"/>
                                </t>
                                -
                                <t t-if="o.company_id.street2">
                                    <span t-field="o.company_id.street2"/>
                                </t>
                            </span>
                              <b>City:</b>
                            <span>
                                <t t-if="o.company_id.city">
                                    <span t-field="o.company_id.city"/>
                                </t>
                            </span>
                              <b>Tel:</b>
                            <span>
                                <t t-if="o.company_id.phone">
                                    <span t-field="o.company_id.phone"/>
                                </t>
                            </span>
                        </t>
                    </div>
                    <div class="col-xs-6" style="text-align:right;border-top: 1px solid #808080;">
                        <small>
                            <span>Page</span>
                            <span class="page" />
                            of
                            <span class="topage" />
                        </small>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <!--Header footer for  report-->
    <template id="progect_progress_report_header_footer">
        <t t-call="project_management.project_progress_report_header"/>
        <t t-raw="0"/>
        <t t-call="project_management.project_progress_report_footer"/>
    </template>

    <template id="report_project_progress_report">
        <t t-call="report.html_container">
            <t t-call="project_management.progect_progress_report_header_footer">
                <t t-foreach="docs" t-as="o">
                    <div class="page">
                        <div class="row">
                            <style type="text/css">
                                .table_head{
                                font-size:12px;
                                font-weight: bold;
                                text-align:left;
                                }
                                .table_cell{
                                font-size:12px;
                                text-align-left;
                                }
                                .title{
                                font-size:12px;
                                font-weight: bold;
                                }
                                .table_head_index{
                                font-size:12px;
                                font-weight: bold;
                                text-align:center;
                                }
                                .table_cell_index{
                                font-size:12px;
                                text-align:center;
                                }
                            </style>
                            <!-- Project General Information -->
                            <table class="table table-bordered"
                                   style="border: 1px solid #000000;font-size:13px;width:100%;"
                                   name="project_progress_general">
                                <tbody>
                                    <tr style="background-color: #B7B7B7;">
                                        <td height="10%" colspan="4"
                                            class="text-left td_bg tr_bg"
                                            style="color:#8b0000;">
                                            <b>Project General Information
                                            </b>
                                        </td>
                                    </tr>
                                    <tr >
                                        <td height="10%" width="15px;"
                                            class="table_head">
                                            <b>Project Name</b>
                                        </td>
                                        <td height="10%" width="35%;"
                                            class="table_cell">
                                            <span t-esc="o.name"/>
                                        </td>
                                        <td height="10%" width="15px;"
                                            class="table_head">
                                            <b>
                                                Project Status
                                            </b>
                                        </td>
                                        <td height="10%" width="200px;"
                                            class="table_cell">
                                            <t
                                                    t-esc="dict(o.fields_get(allfields=['project_status'])['project_status']['selection'])[o.project_status]"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td height="10%"
                                            class="table_head">
                                            <b>Client Name</b>
                                        </td>
                                        <td height="10%"
                                            class="table_cell"
                                            colspan="3">
                                            <span
                                                    t-esc="o.partner_id.name"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td height="10%"
                                            class="table_head">
                                            <b>Contract / WO Value (SAR)</b>
                                        </td>
                                        <td height="10%"
                                            class="table_cell">
                                            <span t-esc="'{0:,.2f}'.format(float(o.contract_value))"/>
                                        </td>
                                        <td height="10%"
                                            class="table_head">
                                            <b>Contract Signing Date</b>
                                        </td>
                                        <td height="10%"
                                            class="table_cell">
                                            <span
                                                    t-field="o.contract_signing_date"
                                                    t-field-options='{"format": "dd-MMM-YYYY"}'/>
                                        </td>

                                    </tr>
                                    <tr>
                                        <td height="10%"
                                            class="table_head">
                                            <b>Project Manager</b>
                                        </td>
                                        <td height="10%"
                                            class="table_cell">
                                            <span
                                                    t-esc="o.user_id.name"/>
                                        </td>
                                        <td height="10%"
                                            class="table_head">
                                            <b>Sponsor</b>
                                        </td>
                                        <td height="10%"
                                            class="table_cell">
                                            <span
                                                    t-esc="o.project_sponsor_id.name"/>
                                        </td>

                                    </tr>
                                    <tr>
                                        <td height="10%"
                                            class="table_head">
                                            <b>Type of Project</b>
                                        </td>
                                        <td height="10%"
                                            class="text-center"
                                            colspan="3">
                                            <span
                                                    t-esc="o.project_type.name"/>
                                        </td>

                                    </tr>
                                </tbody>
                            </table>

                            <!-- Project schedule -->
                            <table class="table table-bordered"
                                   width="100%" height="100%"
                                   style="border: 1px solid #000000;font-size:13px"
                                   name="project_schedule">
                                <tbody>
                                    <tr  style="background-color: #B7B7B7;">
                                        <td height="10%" colspan="4"
                                            class="text-left td_bg" style="color:#8b0000;">
                                            <b>Project Time-Line</b>
                                        </td>
                                    </tr>
                                    <tr class="tr_bg">
                                        <td height="10%"
                                            class="table_head">
                                            <b>Planned Start Date</b>
                                        </td>
                                        <td height="10%"
                                            class="table_cell">
                                            <span
                                                    t-field="o.date_start"
                                                    t-field-options='{"format": "dd-MMM-YYYY"}'/>
                                        </td>
                                        <td height="10%"
                                            class="table_head">
                                            <b>
                                                Planned End Date
                                            </b>
                                        </td>
                                        <td height="10%"
                                            class="table_cell">
                                            <span
                                                    t-field="o.date"
                                                    t-field-options='{"format": "dd-MMM-YYYY"}'/>
                                        </td>

                                    </tr>
                                    <tr>
                                        <td height="10%"
                                            class="table_head">
                                            <b>Actual Start Date</b>
                                        </td>
                                        <td height="10%"
                                            class="table_cell">
                                            <span
                                                    t-field="o.actual_start_date"
                                                    t-field-options='{"format": "dd-MMM-YYYY"}'/>
                                        </td>
                                        <td height="10%"
                                            class="table_head">
                                            <b>
                                                Actual End Date
                                            </b>
                                        </td>
                                        <td height="10%"
                                            class="table_cell">
                                            <span
                                                    t-field="o.actual_end_date"
                                                    t-field-options='{"format": "dd-MMM-YYYY"}'/>
                                        </td>

                                    </tr>


                                </tbody>
                            </table>


                            <!--Initial Project Risks-->
                            <t t-set="risk_data" t-value="o.get_risk_data()"/>
                            <t t-if="risk_data">
                                <table class="table table-bordered"
                                       width="100%" height="100%"
                                       style="border: 1px solid #000000;font-size:13px"
                                       name="project_progress_risk">
                                    <tbody>
                                        <tr style="background-color: #B7B7B7;">
                                            <td height="10%" colspan="7"
                                                class="text-left td_bg" style="color:#8b0000;">
                                                <b>Project Risk/s</b>
                                            </td>
                                        </tr>
                                        <tr   style="background-color: #B7B7B7;">
                                            <td height="10%"
                                                class="td_bg2 table_head_index">
                                                <b>#</b>
                                            </td>
                                            <td height="10%" width="19%"
                                                class="td_bg2 table_head">
                                                <b>Name</b>
                                            </td>
                                            <td height="10%" width="12.5%"
                                                class="td_bg2 table_head">
                                                <b>Responsibility</b>
                                            </td>
                                            <td height="10%" width="13%"
                                                class="td_bg2 table_head">
                                                <b>Impact</b>
                                            </td>
                                            <td height="10%" width="37.5%"
                                                class="td_bg2 table_head">
                                                <b>Proposed Resolution</b>
                                            </td>
                                            <td height="10%"  width="18%"
                                                class="td_bg2 table_head">
                                                <b>Due Date</b>
                                            </td>
                                            <td height="10%"  width="18%"
                                                class="td_bg2 table_head">
                                                <b>Status</b>
                                            </td>
                                        </tr>
                                        <t t-if="risk_data">
                                            <t t-foreach="risk_data" t-as="risk">
                                                <tr>
                                                    <td height="10%"
                                                        class="table_cell_index">
                                                        <span
                                                                t-esc="risk_index+1"/>
                                                    </td>
                                                    <td height="10%" style="overflow:hidden;text-overflow: ellipsis;"
                                                        class="table_cell">
                                                        <span
                                                                t-esc="risk.name"/>
                                                    </td>
                                                    <td height="10%" style="overflow:hidden;text-overflow: ellipsis;"
                                                        class="table_cell">
                                                        <t
                                                                t-if="risk.main_assignment == 'internal'">
                                                            <span
                                                                    t-esc="risk.assigned_to.name"/>
                                                        </t>
                                                          <t
                                                                t-if="risk.main_assignment == 'external'">
                                                            <span
                                                                    t-esc="risk.assigned_to_external"/>
                                                        </t>

                                                    </td>
                                                    <td height="10%" style="overflow:hidden;text-overflow: ellipsis;"
                                                        class="table_cell">
                                                        <t t-esc="dict(risk.fields_get(allfields=['impact'])['impact']['selection'])[risk.impact]"/>
                                                    </td>
                                                    <td height="10%" style="overflow:hidden;text-overflow: ellipsis;"
                                                        class="table_cell">
                                                        <span
                                                                t-esc="risk.required_action"/>
                                                    </td>
                                                    <td height="10%" style="overflow:hidden;text-overflow: ellipsis;"
                                                        class="table_cell">
                                                        <span
                                                                t-field="risk.due_date"
                                                                t-field-options='{"format": "dd-MMM-YYYY"}'/>
                                                    </td>
                                                    <td height="10%" style="overflow:hidden;text-overflow: ellipsis;"
                                                        class="table_cell">
                                                        <span
                                                                t-esc="risk.stage_id.name"/>
                                                    </td>
                                                </tr>
                                            </t>
                                        </t>
                                    </tbody>
                                </table>
                            </t>

                            <!--Initial Project Issue-->
                            <t t-set="issue_data"
                               t-value="o.get_issue_data()"/>
                            <t t-if="issue_data">
                                <table class="table table-bordered"
                                       width="100%" height="100%"
                                       style="border: 1px solid #000000;font-size:13px"
                                       name="project_progress_issue">
                                    <tbody>
                                        <tr  style="background-color: #B7B7B7;">
                                            <td height="10%" colspan="7"
                                                class="text-left td_bg" style="color:#8b0000;">
                                                <b>Project Issue/s</b>
                                            </td>
                                        </tr>
                                        <tr  style="background-color: #B7B7B7;">
                                            <td height="10%"
                                                class="td_bg2 table_head_index">
                                                <b>#</b>
                                            </td>
                                            <td height="10%"  width="19%"
                                                class="td_bg2 table_head">
                                                <b>Name</b>
                                            </td>
                                            <td height="10%" width="12.5%"
                                                class="td_bg2 table_head">
                                                <b>Responsibility</b>
                                            </td>
                                            <td height="10%" width="13%"
                                                class="td_bg2 table_head">
                                                <b>Impact</b>
                                            </td>
                                            <td height="10%"
                                                class="td_bg2 table_head">
                                                <b>Proposed Resolution</b>
                                            </td>
                                            <td height="10%"  width="18%"
                                                class="td_bg2 table_head">
                                                <b>Due Date</b>
                                            </td>
                                            <td height="10%"  width="18%"
                                                class="td_bg2 table_head">
                                                <b>Status</b>
                                            </td>
                                        </tr>
                                        <t t-if="issue_data">
                                            <t t-foreach="issue_data" t-as="issue">
                                                <tr>
                                                    <td height="10%" style="overflow:hidden;text-overflow: ellipsis;"
                                                        class="table_cell_index">
                                                        <span
                                                                t-esc="issue_index+1"/>
                                                    </td>
                                                    <td height="10%" width=""
                                                        class="table_cell">
                                                        <span style="overflow:hidden;text-overflow: ellipsis;"
                                                              t-esc="issue.name"/>
                                                    </td>
                                                    <td height="10%" style="overflow:hidden;text-overflow: ellipsis;"
                                                        class="table_cell">
                                                        <t
                                                                t-if="issue.main_assignment == 'internal'">
                                                            <span
                                                                    t-esc="issue.user_id.name"/>
                                                        </t>
                                                          <t
                                                                t-if="issue.main_assignment == 'external'">
                                                            <span
                                                                    t-esc="issue.assigned_to_external"/>
                                                        </t>

                                                    </td>
                                                    <td height="10%"
                                                        class=" table_cell">
                                                        <t
                                                                t-if="issue.severity">
                                                            <t
                                                                    t-esc="dict(issue.fields_get(allfields=['severity'])['severity']['selection'])[issue.severity]"/>
                                                        </t>
                                                    </td>
                                                    <td height="10%"
                                                        class="table_cell" style="overflow:hidden;text-overflow: ellipsis;">
                                                        <span
                                                                t-esc="issue.required_action"/>
                                                    </td>
                                                    <td height="10%"
                                                        style="overflow:hidden;text-overflow: ellipsis;"
                                                        class="table_cell">
                                                        <span
                                                                t-field="issue.actual_end_date"
                                                                t-field-options='{"format": "dd-MMM-YYYY"}'/>
                                                    </td>
                                                    <td height="10%"
                                                        class="table_cell" style="overflow:hidden;text-overflow: ellipsis;">
                                                        <span
                                                                t-esc="issue.stage_id.name"/>
                                                    </td>
                                                </tr>
                                            </t>
                                        </t>
                                    </tbody>
                                </table>
                            </t>
                        </div>
                    </div>
                </t>
            </t>
        </t>
    </template>

</odoo>