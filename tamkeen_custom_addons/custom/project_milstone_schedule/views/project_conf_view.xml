<?xml version="1.0" encoding="utf-8"?>

<odoo>

    <!-- Risks From View add milestone -->
    <record id="form_view_project_risks_milestone" model="ir.ui.view">
        <field name="name">form.view.project.risks.milestone</field>
        <field name="model">project.risks</field>
        <field name="inherit_id"
               ref="project_management.form_view_project_risks"/>
        <field name="arch" type="xml">
            <field name="project_id" position="attributes">
                <!--<attribute name="readonly">0</attribute>-->
                <attribute name="required">1</attribute>
            </field>
            <field name="project_id" position="after">
                <field name="milestones_schedule_id" options="{'no_open': True,'no_create': True,'no_quick_create': True,'no_create_edit': True, 'limit':1000}"
                       domain="[('project_id', '=', project_id)]"
                       required="1"/>
            </field>
        </field>
    </record>

    <record id="project_issue_milestone_form_view" model="ir.ui.view">
        <field name="name">project.issue.milestone.form.view</field>
        <field name="model">project.issue</field>
        <field name="inherit_id"
               ref="project_issue.project_issue_form_view"/>
        <field name="arch" type="xml">
            <field name="project_id" position="attributes">
                <!--<attribute name="readonly">0</attribute>-->
                <attribute name="required">1</attribute>
            </field>
            <field name="project_id" position="after">
                <field name="milestones_schedule_id" options="{'no_open': True,'no_create': True,'no_quick_create': True,'no_create_edit': True, 'limit':1000}"
                       domain="[('project_id', '=', project_id)]"
                       required="1"/>
            </field>
        </field>
    </record>

    <record id="project_task_form_milestone" model="ir.ui.view">
        <field name="name">project.task.form.milestone</field>
        <field name="model">project.task</field>
        <field eval="2" name="priority"/>
        <field name="inherit_id"
               ref="project.view_task_form2"/>
        <field name="arch" type="xml">
            <field name="project_id" position="attributes">
                <!--<attribute name="readonly">0</attribute>-->
                <attribute name="required">1</attribute>
                <attribute name="options">{'no_create': True,'no_quick_create':True,'no_create_edit':True,'limit':1000}</attribute>
            </field>
            <field name="project_id" position="after">
                <field name="milestones_schedule_id" options="{'no_create': True,'no_quick_create':True,'no_create_edit':True,'limit':1000}"
                       domain="[('project_id', '=', project_id)]"
                       required="1"/>
            </field>
        </field>
    </record>
    <!--Task action for milestone-->
    <record id="act_project_project_task_milestones"
            model="ir.actions.act_window">
        <field name="name">Task</field>
        <field name="res_model">project.task</field>
        <field name="view_mode">tree,kanban,form,calendar,pivot,graph</field>
        <field name="context">{
            'default_milestones_schedule_id': active_id,
            'default_project_id': context.get('project_id', False)
            }</field>
        <field name="domain">[('milestones_schedule_id','=',[active_id])]</field>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Here, you can create new tasks
            </p>
            <p>
                You can     now manage your tasks in order to get things done efficiently. Track progress, discuss, attach documents, etc.
            </p>
        </field>
    </record>

    <!-- action for risk smart button for milestone -->
    <record id="action_view_project_risks_from_milestone"
            model="ir.actions.act_window">
        <field name="name">Risk</field>
        <field name="res_model">project.risks</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{
            'default_milestones_schedule_id': active_id,
            'default_project_id': context.get('project_id', False),
            }</field>
        <field name="domain">[('milestones_schedule_id','=',[active_id])]</field>
        <field name="help" type="html">
            <p>
                Project management allows you to manage the pipeline of
                your risks efficiently. You can track progress.
            </p>
        </field>
    </record>

     <!-- action for risk smart button for milestone -->
    <record id="action_view_project_issue_from_milestone"
            model="ir.actions.act_window">
        <field name="name">Issue</field>
        <field name="res_model">project.issue</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{
            'default_milestones_schedule_id': active_id,
            'default_project_id': context.get('project_id', False),
            }</field>
        <field name="domain">[('milestones_schedule_id','=',[active_id])]</field>
        <field name="help" type="html">
            <p>
                Project management allows you to manage the pipeline of
                your issue efficiently. You can track progress.
            </p>
        </field>
    </record>
</odoo>
